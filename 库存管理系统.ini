库存管理系统
 
前端：nextJs + react + tailwindcss
后端： ASP.net c# mysql

数据表：
商品分类表：
	id
	分类名 string

进货渠道表：
	id
	渠道名 string

商品表：
	id
	分类id
	品名 string
	照片 string

进货表：
    id
	进货渠道id
	进货日期 date
	进货单号 string	（唯一）
    进货货币类型 currency_type (string: CNY/USD/JPY等)
    汇率 exchange_rate (number，相对于基准货币的汇率)
    原始支出 number
    汇率换算后支出 number （根据汇率自动计算）

在库表：
	id
	商品id
    进货id
	进货支出 number
	进货数量 number
	单件成本 number 单件成本 = (进货支出 * 汇率) / 进货数量 单件成本保存后不允许修改
	在库数量 number

订单表: 	
	id
	图片url string
	订单编号 string
	收入金额 number
    成本 number（初始值为null，保存订单详细时自动计算并更新）
	交易时间日期 dateTime
	
订单详细表：
	id
	订单id	
    在库id
    商品id
    出库单价 (快照字段，保存时从在库表复制)
	数量 number
	包装成本 number
	其他成本 number
    小计成本 number （出库单价*数量+包装+其他）
	备注 string

*所有表均包含：
    创建时间 created_at
    更新时间 updated_at
    是否删除 is_deleted

页面：
1. 订单列表
	读取数据库，显示订单一览
	支持按编号，金额，成本，交易时间等排序
    成本为null时显示"未输入"（即订单详细表中无记录）
	成本为null的行默认排到最前面
	点击成本列的数字/未输入文字，跳转到【2.a订单详细】页面
    添加搜索功能（按编号、时间范围）
    添加批量导出功能（Excel/CSV）
    显示利润列（收入-成本）
    订单不可删除

2.a 订单详细
    用于单个订单的编辑
	path中包含订单id
	显示订单id对应的订单信息卡片
	显示包含【商品名，进货单价，数量，包装成本，其他成本，小计成本，备注】的列表
    实时计算并显示：订单总成本、总利润
	列表初期显示为【订单详细表】里的订单id所对应的内容，并可进行增删修改等操作
	商品名通过下拉菜单选择，进货单价为只读，其他为手动输入
    点击商品名的下拉菜单时，根据在库表内容显示二级菜单
        第一级：商品分类（来自分类表）； 第二级：【商品名，在库数量】（来自在库表的在库数量>0的数据）
    从下拉菜单选中在库行后，对应的进货单价自动显示，focus自动跳【数量】列
    若输入的【数量】超过选中的在库数量，输入数量标红
    【包装成本，其他成本，备注】为非必须选项
    【小计成本】为自动算出
	列表每行右侧显示x按钮供删除行
	列表下侧显示【追加，保存，取消】按钮
	点击追加按钮，增加新行
    在点击保存按钮之前，所有增加、修改及删除操作均只体现在前端，未反映到DB
	点击保存按钮，反映所有增加，修改及删除操作
    保存订单详细时自动计算并更新订单表的成本
    保存订单详细时自动计算并更新库存表的在库数量
    保存时的库存更新规则：
        1. 新增行：在库数量 -= 订单数量
        2. 修改行：
            - 如果更换了商品/在库批次：原在库+原数量，新在库-新数量
            - 如果只修改数量：在库数量调整差额
        3. 删除行：在库数量 += 原订单数量
        4. 所有操作需在数据库事务中完成
    若存在标红的【数量】，或存在【商品名，进货单价，数量】未输入行时，保存按钮非活性
    保存订单详细时，自动更新在库表的在库数量
	点击取消按钮，弹出确认对话框， 确认后重新读取数据库内容

2.b 订单详细（只读）
    显示多个订单的订单详细内容
    支持20-50行分页
    支持按订单号，订单日期，库存id，进货日期，进货单号，商品名，商品分类等筛选

3.  进货列表
	支持进货信息的crud操作
    仅支持单行操作
    无需分页功能
    支持按进货日期筛选
    支持点击各行跳转到对应的在库列表页
    保存输入的汇率到localstorage，增加行时自动读入

4.  在库列表
	支持在库信息的crd操作（不支持update）
    无需分页功能
    支持按商品名/进货日期范围/进货单号/进货渠道筛选
    新建行时必须通过下拉菜单选择进货id
    选择进货id后，显示该进货的货币和汇率
    新增行自动使用该进货的货币/汇率
    不允许混合不同进货id的记录编辑
    手动输入原货币的支出金额，根据汇率自动计算支出金额
    只保存汇率自动计算后的支出金额（手动输入部分不保存）
    支持多行追加操作，进货支出总和与进货表的汇率换算后支出相匹配时才可保存
        [进货表支出: ¥1000] [当前分配总和: ¥800] [差额: -¥200]
        差额不为0时保存按钮非活性
        后端：保存前验证总和是否匹配
    手动分配每个商品的进货支出

5. 商品列表
	支持商品信息的crud操作
    仅支持单行操作
    无需分页功能，显示读取记录总条数
    支持按分类筛选
6. 分类编辑
	列表支持分类信息的crud操作
    仅支持单行操作
    无需分页功能，显示读取记录总条数
7. 进货渠道
	列表支持渠道信息的crud操作
    仅支持单行操作
    无需分页功能，显示读取记录总条数

8. 主页面
	可跳转到1，2.b，3，4，5，6，7页面
    添加数据统计dashboard
        总库存价值 = sum(在库数量 * 单件成本)
        月度利润 = 当月订单收入 - 成本 简单柱状图即可

技术实现：
前端：
    前端使用React Hook Form + Zod验证
    使用Zustand或React Context管理表单状态
    实现乐观UI更新（保存前预览效果）

后端：
    订单保存应使用数据库事务（确保订单和库存同步更新）
    API设计RESTful规范
    添加并发控制（防止库存超卖）

数据库：
    在外键字段建立索引
    订单编号字段建立唯一索引
    在库数量添加check约束 >= 0
    使用数据库事务 + 行锁

